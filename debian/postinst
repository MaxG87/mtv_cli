#!/bin/bash
# vim:ft=sh:ai:et:si:sts=4:sw=4
#
# postinst script for mtvclient
#
set -e
. /usr/share/debconf/confmodule

declare -a CONFIG=(
msg_level
date_cutoff
dauer_cutoff
num_downloads
ziel_downloads
qualitaet
)

declare -a WEB=(
port
host
)

case "$1" in
    reconfigure|configure)
# use config template
        cp -fT "/usr/share/mtvclient/mtv_cli.conf" "/usr/share/mtvclient/mtv_cli.conf.new"

# update new config with values from debconf
# section CONFIG
        for c in "${CONFIG[@]}" 
        do
            if db_get mtvclient/${c} && [[ -n "${RET}" ]]; then
                crudini --set "/usr/share/mtvclient/mtv_cli.conf.new" CONFIG "${c^^}" "${RET}"
            fi
        done

# section WEB
        for w in "${WEB[@]}"
        do
            if db_get mtvclient/${w} && [[ -n "${RET}" ]]; then
                crudini --set "/usr/share/mtvclient/mtv_cli.conf.new" WEB "${w^^}" "${RET}"
            fi
        done
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)
    ;;

    triggered)
    ;;


    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
